import{k as x,b as $,c as p,h as f,d as k,j as e,S as Q}from"./index-3NETQRPl.js";import{e as K,h as E,u as F,f as h,b as m}from"./helpers-Bi5bTQUP.js";function G(){const{bookingId:s}=x(),{data:t,isLoading:n,error:o}=$({queryKey:["booking",Number(s)],queryFn:()=>K(Number(s))});return{booking:t,isLoading:n,error:o}}function U(){const s=p(),t=f(),{mutate:n,isPending:o,error:a}=k({mutationFn:E,onSuccess:()=>{s.invalidateQueries({queryKey:["bookings"]}),t(-1)}});return{deleteBooking:n,isDeleting:o,error:a}}function L(){const s=p(),{bookingId:t}=x(),{mutate:n,isPending:o,error:a}=k({mutationFn:function({bookingId:r,newData:l}){return F(r,l)},onSuccess:()=>{s.invalidateQueries({queryKey:["booking",Number(t)]}),s.invalidateQueries({queryKey:["bookings"]})},onError:r=>{console.warn(r.message)}});return{updateBooking:n,isUpdating:o,error:a}}function R(){const s=f(),{bookingId:t}=x(),{booking:n,isLoading:o}=G(),{deleteBooking:a,isDeleting:r}=U(),{updateBooking:l,isUpdating:N}=L();if(o||r||N||!n)return e.jsx(Q,{});const{startDate:y,endDate:v,numNights:B,numGuests:w,hasBreakfast:D,observations:C,isPaid:g,status:i,cabinPrice:P,extrasPrice:q,totalPrice:I,apartments:d,guests:M}=n||{},S={"checked-out":"bg-stone-200 text-stone-700","checked-in":"bg-emerald-100 text-emerald-700",unconfirmed:"bg-amber-100 text-amber-700"};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>s(-1),className:"text-xl text-stone-600 hover:text-stone-900 cursor-pointer",children:"← Back to Bookings"}),e.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-semibold
            ${S[i]}
          `,children:i.replace("-"," ")})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("img",{src:d.image,alt:d.name,className:"w-64 h-40 object-cover rounded-xl shadow"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold",children:["Apartment ",d.name]}),e.jsxs("p",{className:"text-stone-600 mt-1",children:["Hosted for ",e.jsx("span",{className:"font-medium",children:M.fullName})]})]})]}),e.jsxs("div",{className:"grid grid-cols-[2fr_1fr] gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{title:"Stay details",children:[e.jsxs(c,{label:"Dates",children:[h(new Date(y),"MMM d yyyy")," →"," ",h(new Date(v),"MMM d yyyy")]}),e.jsx(c,{label:"Nights",children:B}),e.jsx(c,{label:"Guests",children:w}),e.jsx(c,{label:"Breakfast",children:D?"Included":"Not included"})]}),e.jsx(b,{title:"Guest notes",children:e.jsx("p",{className:"text-stone-600",children:C||"No additional notes"})})]}),e.jsxs("div",{className:"rounded-xl border border-stone-200 bg-stone-50 p-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Price summary"}),e.jsx(j,{label:"Cabin price",value:`${m(P)}`}),e.jsx(j,{label:"Extras",value:`${m(q)}`}),e.jsxs("div",{className:"border-t pt-3 flex justify-between font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:m(I)})]}),e.jsx("div",{className:`text-xl font-medium ${g||i==="checked-out"?"text-emerald-700":"text-red-600"}`,children:g||i==="checked-out"?"Paid":"Payment pending (Will pay at reception)"}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[i==="unconfirmed"&&e.jsx("button",{onClick:()=>{const u={status:"checked-in"};l({bookingId:Number(t),newData:u})},className:"flex-1 rounded-md bg-emerald-600 text-white py-2 hover:bg-emerald-700 cursor-pointer",children:"Check in"}),i==="checked-in"&&e.jsx("button",{onClick:()=>{const u={status:"checked-out"};l({bookingId:Number(t),newData:u})},className:"flex-1 rounded-md bg-stone-700 text-white py-2 hover:bg-stone-800 cursor-pointer",children:"Check out"}),e.jsx("button",{onClick:()=>{a(Number(t))},className:"flex-1 rounded-md bg-red-500 text-white py-2 hover:bg-red-700 cursor-pointer",children:"Delete Booking"})]})]})]})]})}function b({title:s,children:t}){return e.jsxs("div",{className:"rounded-xl border border-stone-200 bg-white p-6",children:[e.jsx("h2",{className:"font-semibold text-lg mb-4",children:s}),e.jsx("div",{className:"space-y-2",children:t})]})}function c({label:s,children:t}){return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-stone-500",children:s}),e.jsx("span",{className:"font-medium",children:t})]})}function j({label:s,value:t}){return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-stone-500",children:s}),e.jsx("span",{children:t})]})}function T(){return e.jsx("div",{className:"pt-5",children:e.jsx(R,{})})}export{T as default};
