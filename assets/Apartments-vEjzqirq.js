import{r as m,j as e,c as x,d as p,e as b,b as A,u as N,S as v}from"./index-B12FuQRA.js";import{a as C,d as q,b as S,g as P,e as w,u as E,F}from"./Filter-DXZoNkqr.js";import{i as D,d as k,s as M,a as B,u as T,g as _,C as I,T as L,c as Q,M as $,B as K,F as O,I as R,b as U,e as G,f as H}from"./MoreVert-mrxYmkOy.js";import{c as V}from"./index-BDrmvh2l.js";import{u as z}from"./index.esm-BmF4lNU3.js";const J=t=>{const s={systemProps:{},otherProps:{}},n=t?.theme?.unstable_sxConfig??k;return Object.keys(t).forEach(r=>{n[r]?s.systemProps[r]=t[r]:s.otherProps[r]=t[r]}),s};function W(t){const{sx:s,...n}=t,{systemProps:r,otherProps:i}=J(n);let o;return Array.isArray(s)?o=[r,...s]:typeof s=="function"?o=(...d)=>{const a=s(...d);return D(a)?{...r,...a}:r}:o={...r,...s},{...i,sx:o}}function X(t={}){const{themeId:s,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,o=M("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(B);return m.forwardRef(function(c,f){const u=T(n),{className:h,component:l="div",...y}=W(c);return e.jsx(o,{as:l,ref:f,className:V(h,i?i(r):r),theme:s&&u[s]||u,...y})})}const Y=_("MuiBox",["root"]),Z=Q(),ee=X({themeId:L,defaultTheme:Z,defaultClassName:Y.root,generateClassName:I.generate}),te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"none",borderRadius:"2%",boxShadow:24,p:4};function g({children:t,handleCloseMenuItem:s,setAddApartment:n}){const[r,i]=m.useState(!0),o=()=>i(!1);return e.jsx("div",{children:e.jsx($,{"aria-labelledby":"Edit Apartment","aria-describedby":"Edit your already created Apartment",open:r,onClose:()=>{o(),s?.(),n?.(!1)},closeAfterTransition:!0,slots:{backdrop:K},slotProps:{backdrop:{timeout:500}},children:e.jsx(O,{in:r,children:e.jsx(ee,{sx:te,children:t})})})})}function j({data:t,saveButtonText:s,onSubmit:n,closeForm:r}){const{register:i,handleSubmit:o,reset:d,formState:{errors:a}}=z();return m.useEffect(()=>{t&&d(t)},[t,d]),e.jsxs("form",{onSubmit:o(n),className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image URL"}),e.jsx("input",{type:"text",...i("image",{required:!0}),className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.image?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"Image is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",...i("name",{required:!0}),className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.name?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"First name is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Capacity"}),e.jsx("input",{type:"number",...i("maxCapacity",{required:!0,valueAsNumber:!0}),className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.maxCapacity?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"Capacity is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Price"}),e.jsx("input",{type:"number",...i("regularPrice",{required:!0,valueAsNumber:!0}),className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.regularPrice?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"Price is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Discount"}),e.jsx("input",{type:"number",...i("discount",{required:!0,valueAsNumber:!0}),className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.discount?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"Discount is required"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{...i("description",{required:!0}),rows:4,className:"w-full rounded-md border border-stone-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-400"}),a.description?.type==="required"&&e.jsx("p",{className:"text-red-400",role:"alert",children:"Description is required"})]}),e.jsxs("div",{className:"col-span-2 flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"px-4 py-2 rounded-md border border-stone-300 hover:bg-stone-100 cursor-pointer",onClick:r,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-emerald-500 text-white font-semibold rounded-lg shadow-md hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-400 transition duration-200 ease-in-out cursor-pointer",children:s})]})]})}function se(){const t=x(),{mutate:s,isPending:n}=p({mutationFn:C,onSuccess:()=>{t.invalidateQueries({queryKey:["apartments"]})}});return{addApartment:s,isCreating:n}}function re({closeForm:t}){const{addApartment:s,isCreating:n}=se(),r=i=>{s(i),t(!1)};return n?e.jsx(b,{}):e.jsxs("div",{className:"w-full max-w-3xl mx-auto",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-6",children:"Edit Apartment"}),e.jsx(j,{onSubmit:r,closeForm:()=>t(!1),saveButtonText:"Add Apartment"})]})}function ne(){const t=x(),{isPending:s,mutate:n}=p({mutationFn:r=>q(r),onSuccess:()=>{t.invalidateQueries({queryKey:["apartments"]})}});return{isDeleting:s,deleteApartment:n}}function ie(){const t=x(),{isPending:s,mutate:n}=p({mutationFn:S,onSuccess:()=>{t.invalidateQueries({queryKey:["apartments"]})}});return{isDuplicating:s,duplicateApartment:n}}function ae(t){const{data:s,isLoading:n,error:r}=A({queryKey:["apartment"],queryFn:()=>P(t)});return{apartment:s,isLoading:n,error:r}}function oe(){const t=x(),{mutate:s,isPending:n}=p({mutationFn:({id:r,data:i})=>w(r,i),onSuccess:()=>{t.invalidateQueries({queryKey:["apartments"]})}});return{editApartment:s,isEditing:n}}function le({id:t,handleClose:s}){const{apartment:n,isLoading:r}=ae(t),{editApartment:i,isEditing:o}=oe();if(r||o)return e.jsx(b,{});const d=a=>{i({id:t,data:a}),s()};return e.jsxs("div",{className:"w-full max-w-3xl mx-auto",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-6",children:"Edit Apartment"}),e.jsx(j,{data:n,saveButtonText:"Save changes",onSubmit:d,closeForm:s})]})}function de({id:t}){const{deleteApartment:s,isDeleting:n}=ne(),{duplicateApartment:r,isDuplicating:i}=ie(),[o,d]=m.useState(null),[a,c]=m.useState(!1);if(n||i)return e.jsx(b,{});const f=!!o,u=()=>{d(null),c(!1)},h=l=>{l==="Edit"&&c(!0),l==="Duplicate"&&r(t),l==="Delete"&&s(t),l!=="Edit"&&u()};return e.jsxs(e.Fragment,{children:[e.jsx(R,{sx:{height:"40px",width:"40px"},onClick:l=>d(l.currentTarget),children:e.jsx(U,{})}),e.jsx(G,{anchorEl:o,open:f,onClose:u,children:["Edit","Duplicate","Delete"].map(l=>e.jsx(H,{sx:{padding:"10px 30px"},onClick:()=>h(l),children:l},l))}),a&&e.jsx(g,{handleCloseMenuItem:u,children:e.jsx(le,{handleClose:u,id:t})})]})}function ce({apt:t}){return e.jsxs("div",{className:"grid grid-cols-[0.6fr_1.8fr_2.2fr_1fr_1fr_1fr] gap-x-6 items-center py-2 border-b border-stone-100",children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-16 h-16 object-cover rounded"}),e.jsx("div",{children:t.name}),e.jsx("div",{children:t.maxCapacity}),e.jsx("div",{children:t.regularPrice}),e.jsx("div",{children:t.discount}),e.jsx(de,{id:t.id})]})}function ue(){const{apartments:t,isLoading:s}=E(),[n]=N(),[r,i]=m.useState(!1);if(s||!t)return e.jsx(v,{});const o=t.filter(a=>{const c=n.get("discount")||"all";return c==="all"?!0:c==="discount"?+a.discount>0:c==="no-discount"?+a.discount==0:!0});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-emerald-500 text-white font-semibold rounded-lg shadow-md hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-400 transition duration-200 ease-in-out",children:"Add Apartment"}),r&&e.jsx(g,{setAddApartment:i,children:e.jsx(re,{closeForm:i})}),e.jsxs("div",{className:"grid grid-cols-[0.6fr_1.8fr_2.2fr_1fr_1fr_1fr] gap-x-6 border-b border-stone-200 pb-2 text-lg font-semibold",children:[e.jsx("div",{children:"Image"}),e.jsx("div",{children:"Name"}),e.jsx("div",{children:"Capacity"}),e.jsx("div",{children:"Price"}),e.jsx("div",{children:"Discount"}),e.jsx("div",{children:"Settings"})]}),o.map(a=>e.jsx(ce,{apt:a},a.id))]})}function me(){return e.jsx("div",{children:e.jsx(F,{filterField:"discount",options:[{value:"all",label:"All"},{value:"discount",label:"Discount"},{value:"no-discount",label:"No discount"}]})})}function ge(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between pt-5 pb-5",children:[e.jsx("h3",{className:"text-3xl font-semibold",children:"All Apartments"}),e.jsx(me,{})]}),e.jsx(ue,{})]})}export{ge as default};
